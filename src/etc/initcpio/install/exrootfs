#! /bin/bash

function build ()
{
	add_module fuse
	
	add_binary mount
	##add_binary mount.cifs
	#add_binary mount.curl
	add_binary mount.fuse
	#add_binary mount.glusterfs
	#add_binary mount.ntfs
	#add_binary mount.ntfs-3g
	#add_binary mount.lowntfs-3g
	add_binary mount.nfs
	add_binary mount.nfs4
	add_binary mount.ssh
	add_binary mountpoint
	#add_binary mountstats
	add_binary ssh
	add_binary ls
	#add_binary cd
	add_binary cp
	add_binary pwd
	#add_binary while
	#add_binary read
	add_binary rsync
	add_binary test
	add_binary mkdir
	add_binary rmdir
	add_binary chown
	add_binary echo
	add_binary unison
	add_binary mknod
	add_binary sleep
	add_binary find
	add_binary cpio
	add_binary systemctl
	add_binary sshfs
	
	
	add_binary getent
	add_binary id
	add_binary whoami
	
	add_file /etc/passwd
	add_file /etc/shadow
	add_file /etc/group
	add_file /etc/gshadow
	add_file /etc/sudoers
	add_file /etc/nsswitch.conf
	
	#add_binary "useradd"
	##add_binary "adduser"
	#add_binary "groupadd"
	##add_binary "addgroup"
	
	add_dir /root/.ssh/
	add_file /root/.ssh/authorized_keys
	add_file /root/.ssh/config
	add_file /root/.ssh/id_rsa
	add_file /root/.ssh/id_rsa.pub
	add_file /root/.ssh/known_hosts
	
	# nfs hook:
	add_checked_modules '/drivers/net/'
	add_module nfsv3?
	
	add_binary "/usr/lib/initcpio/ipconfig" "/bin/ipconfig"
	add_binary "/usr/lib/initcpio/nfsmount" "/bin/nfsmount"
	
	# coreutils
	add_binary /usr/bin/[
	add_binary /usr/bin/b2sum
	add_binary /usr/bin/b2sum
	add_binary /usr/bin/base32
	add_binary /usr/bin/base64
	add_binary /usr/bin/base64
	add_binary /usr/bin/basename
	add_binary /usr/bin/cat
	add_binary /usr/bin/chcon
	add_binary /usr/bin/chgrp
	add_binary /usr/bin/chmod
	add_binary /usr/bin/chown
	add_binary /usr/bin/chroot
	add_binary /usr/bin/cksum
	add_binary /usr/bin/comm
	add_binary /usr/bin/cp
	add_binary /usr/bin/csplit
	add_binary /usr/bin/cut
	add_binary /usr/bin/date
	add_binary /usr/bin/dd
	add_binary /usr/bin/df
	add_binary /usr/bin/dir
	add_binary /usr/bin/dircolors
	add_binary /usr/bin/dirname
	add_binary /usr/bin/du
	add_binary /usr/bin/echo
	add_binary /usr/bin/env
	add_binary /usr/bin/expand
	add_binary /usr/bin/expr
	add_binary /usr/bin/factor
	add_binary /usr/bin/false
	add_binary /usr/bin/fmt
	add_binary /usr/bin/fold
	add_binary /usr/bin/head
	add_binary /usr/bin/hostid
	add_binary /usr/bin/id
	add_binary /usr/bin/install
	add_binary /usr/bin/join
	add_binary /usr/bin/link
	add_binary /usr/bin/ln
	add_binary /usr/bin/logname
	add_binary /usr/bin/ls
	add_binary /usr/bin/md5sum
	add_binary /usr/bin/mkdir
	add_binary /usr/bin/mkfifo
	add_binary /usr/bin/mknod
	add_binary /usr/bin/mktemp
	add_binary /usr/bin/mv
	add_binary /usr/bin/nice
	add_binary /usr/bin/nl
	add_binary /usr/bin/nohup
	add_binary /usr/bin/nproc
	add_binary /usr/bin/numfmt
	add_binary /usr/bin/od
	add_binary /usr/bin/paste
	add_binary /usr/bin/pathchk
	add_binary /usr/bin/pinky
	add_binary /usr/bin/pr
	add_binary /usr/bin/printenv
	add_binary /usr/bin/printf
	add_binary /usr/bin/ptx
	add_binary /usr/bin/pwd
	add_binary /usr/bin/readlink
	add_binary /usr/bin/realpath
	add_binary /usr/bin/rm
	add_binary /usr/bin/rmdir
	add_binary /usr/bin/runcon
	add_binary /usr/bin/seq
	add_binary /usr/bin/sha1sum
	add_binary /usr/bin/sha224sum
	add_binary /usr/bin/sha256sum
	add_binary /usr/bin/sha384sum
	add_binary /usr/bin/sha512sum
	add_binary /usr/bin/shred
	add_binary /usr/bin/shuf
	add_binary /usr/bin/sleep
	add_binary /usr/bin/sort
	add_binary /usr/bin/split
	add_binary /usr/bin/stat
	add_binary /usr/bin/stdbuf
	add_binary /usr/bin/stty
	add_binary /usr/bin/sum
	add_binary /usr/bin/sync
	add_binary /usr/bin/tac
	add_binary /usr/bin/tail
	add_binary /usr/bin/tee
	add_binary /usr/bin/test
	add_binary /usr/bin/timeout
	add_binary /usr/bin/touch
	add_binary /usr/bin/tr
	add_binary /usr/bin/true
	add_binary /usr/bin/truncate
	add_binary /usr/bin/tsort
	add_binary /usr/bin/tty
	add_binary /usr/bin/uname
	add_binary /usr/bin/unexpand
	add_binary /usr/bin/uniq
	add_binary /usr/bin/unlink
	add_binary /usr/bin/users
	add_binary /usr/bin/vdir
	add_binary /usr/bin/wc
	add_binary /usr/bin/who
	add_binary /usr/bin/whoami
	add_binary /usr/bin/yes
	add_file /usr/lib/coreutils/libstdbuf.so
	
	# PAM
	add_file /etc/default/passwd
	add_file /etc/environment
	add_file /etc/security/access.conf
	add_file /etc/security/group.conf
	add_file /etc/security/limits.conf
	add_file /etc/security/namespace.conf
	add_file /etc/security/namespace.init
	add_file /etc/security/pam_env.conf
	add_file /etc/security/time.conf
	add_binary /usr/bin/mkhomedir_helper
	add_binary /usr/bin/pam_tally
	add_binary /usr/bin/pam_tally2
	add_binary /usr/bin/pam_timestamp_check
	add_binary /usr/bin/unix_chkpwd
	add_binary /usr/bin/unix_update
	add_file /usr/include/security/_pam_compat.h
	add_file /usr/include/security/_pam_macros.h
	add_file /usr/include/security/_pam_types.h
	add_file /usr/include/security/pam_appl.h
	add_file /usr/include/security/pam_client.h
	add_file /usr/include/security/pam_ext.h
	add_file /usr/include/security/pam_filter.h
	add_file /usr/include/security/pam_misc.h
	add_file /usr/include/security/pam_modules.h
	add_file /usr/include/security/pam_modutil.h
	add_file /usr/lib/libpam.so
	add_file /usr/lib/libpam.so.0
	add_file /usr/lib/libpam.so.0.84.2
	add_file /usr/lib/libpam_misc.so
	add_file /usr/lib/libpam_misc.so.0
	add_file /usr/lib/libpam_misc.so.0.82.1
	add_file /usr/lib/libpamc.so
	add_file /usr/lib/libpamc.so.0
	add_file /usr/lib/libpamc.so.0.82.1
	add_file /usr/lib/security/pam_access.so
	add_file /usr/lib/security/pam_cracklib.so
	add_file /usr/lib/security/pam_debug.so
	add_file /usr/lib/security/pam_deny.so
	add_file /usr/lib/security/pam_echo.so
	add_file /usr/lib/security/pam_env.so
	add_file /usr/lib/security/pam_exec.so
	add_file /usr/lib/security/pam_faildelay.so
	add_file /usr/lib/security/pam_filter.so
	add_file /usr/lib/security/pam_filter/upperLOWER
	add_file /usr/lib/security/pam_ftp.so
	add_file /usr/lib/security/pam_group.so
	add_file /usr/lib/security/pam_issue.so
	add_file /usr/lib/security/pam_keyinit.so
	add_file /usr/lib/security/pam_lastlog.so
	add_file /usr/lib/security/pam_limits.so
	add_file /usr/lib/security/pam_listfile.so
	add_file /usr/lib/security/pam_localuser.so
	add_file /usr/lib/security/pam_loginuid.so
	add_file /usr/lib/security/pam_mail.so
	add_file /usr/lib/security/pam_mkhomedir.so
	add_file /usr/lib/security/pam_motd.so
	add_file /usr/lib/security/pam_namespace.so
	add_file /usr/lib/security/pam_nologin.so
	add_file /usr/lib/security/pam_permit.so
	add_file /usr/lib/security/pam_pwhistory.so
	add_file /usr/lib/security/pam_rhosts.so
	add_file /usr/lib/security/pam_rootok.so
	add_file /usr/lib/security/pam_securetty.so
	add_file /usr/lib/security/pam_shells.so
	add_file /usr/lib/security/pam_stress.so
	add_file /usr/lib/security/pam_succeed_if.so
	add_file /usr/lib/security/pam_tally.so
	add_file /usr/lib/security/pam_tally2.so
	add_file /usr/lib/security/pam_time.so
	add_file /usr/lib/security/pam_timestamp.so
	add_file /usr/lib/security/pam_umask.so
	add_file /usr/lib/security/pam_unix.so
	add_file /usr/lib/security/pam_unix2.so
	add_file /usr/lib/security/pam_unix_acct.so
	add_file /usr/lib/security/pam_unix_auth.so
	add_file /usr/lib/security/pam_unix_passwd.so
	add_file /usr/lib/security/pam_unix_session.so
	add_file /usr/lib/security/pam_warn.so
	add_file /usr/lib/security/pam_wheel.so
	add_file /usr/lib/security/pam_xauth.so
	
	# Manually added
	add_file /usr/lib/libpam.so
	add_file /usr/lib/libpam.so.0
	add_file /usr/lib/libpam.so.0.84.2
	add_file /usr/lib/libpam_misc.so
	add_file /usr/lib/libpam_misc.so.0
	add_file /usr/lib/libpam_misc.so.0.82.1
	add_file /usr/lib/libpamc.so
	add_file /usr/lib/libpamc.so.0
	add_file /usr/lib/libpamc.so.0.82.1
	
	# NSS
	add_binary /usr/bin/certutil
	add_binary /usr/bin/cmsutil
	add_binary /usr/bin/crlutil
	add_binary /usr/bin/derdump
	add_binary /usr/bin/modutil
	add_binary /usr/bin/nss-config
	add_binary /usr/bin/pk12util
	add_binary /usr/bin/pp
	add_binary /usr/bin/shlibsign
	add_binary /usr/bin/signtool
	add_binary /usr/bin/signver
	add_binary /usr/bin/ssltap
	add_binary /usr/bin/symkeyutil
	add_binary /usr/bin/vfychain
	add_binary /usr/bin/vfyserv
	add_file /usr/lib/libcrmf.a
	add_file /usr/lib/libfreebl3.chk
	add_file /usr/lib/libfreebl3.so
	add_file /usr/lib/libfreeblpriv3.chk
	add_file /usr/lib/libfreeblpriv3.so
	add_file /usr/lib/libgtest1.so
	add_file /usr/lib/libnss3.so
	add_file /usr/lib/libnssckbi.so
	add_file /usr/lib/libnssdbm3.chk
	add_file /usr/lib/libnssdbm3.so
	add_file /usr/lib/libnsssysinit.so
	add_file /usr/lib/libnssutil3.so
	add_file /usr/lib/libsmime3.so
	add_file /usr/lib/libsoftokn3.chk
	add_file /usr/lib/libsoftokn3.so
	add_file /usr/lib/libssl3.so
	add_file /usr/lib/pkgconfig/mozilla-nss.pc
	add_file /usr/lib/pkgconfig/nss.pc
	
	# Manually added
	add_file /usr/lib/libnss3.so
	add_file /usr/lib/libnss_compat-2.25.so
	add_file /usr/lib/libnss_compat.so
	add_file /usr/lib/libnss_compat.so.2
	add_file /usr/lib/libnss_db-2.25.so
	add_file /usr/lib/libnss_db.so
	add_file /usr/lib/libnss_db.so.2
	add_file /usr/lib/libnss_dns-2.25.so
	add_file /usr/lib/libnss_dns.so
	add_file /usr/lib/libnss_dns.so.2
	add_file /usr/lib/libnss_files-2.25.so
	add_file /usr/lib/libnss_files.so
	add_file /usr/lib/libnss_files.so.2
	add_file /usr/lib/libnss_hesiod-2.25.so
	add_file /usr/lib/libnss_hesiod.so
	add_file /usr/lib/libnss_hesiod.so.2
	add_file /usr/lib/libnss_myhostname.so.2
	add_file /usr/lib/libnss_mymachines.so.2
	add_file /usr/lib/libnss_nis-2.25.so
	add_file /usr/lib/libnss_nis.so
	add_file /usr/lib/libnss_nis.so.2
	add_file /usr/lib/libnss_nisplus-2.25.so
	add_file /usr/lib/libnss_nisplus.so
	add_file /usr/lib/libnss_nisplus.so.2
	add_file /usr/lib/libnss_resolve.so.2
	add_file /usr/lib/libnss_systemd.so.2
	add_file /usr/lib/libnssckbi-p11-kit.so
	add_file /usr/lib/libnssckbi.so
	add_file /usr/lib/libnssdbm3.chk
	add_file /usr/lib/libnssdbm3.so
	add_file /usr/lib/libnsssysinit.so
	add_file /usr/lib/libnssutil3.so
	
	# dhclient
	add_dir /etc/
	add_dir /usr/
	add_dir /usr/bin/
	add_binary /usr/bin/dhclient
	add_binary /usr/bin/dhclient-script
	add_dir /usr/lib/
	add_dir /usr/lib/systemd/
	add_dir /usr/lib/systemd/system/
	add_file /usr/lib/systemd/system/dhclient@.service
	add_dir /usr/share/
	add_dir /usr/share/dhclient/
	add_file /usr/share/dhclient/dhclient.conf.example
	add_dir /var/
	add_dir /var/lib/
	add_dir /var/lib/dhclient/
	
	# openssh
	add_dir /etc/
	add_dir /etc/pam.d/
	add_file /etc/pam.d/sshd
	add_dir /etc/ssh/
	add_file /etc/ssh/moduli
	add_file /etc/ssh/ssh_config
	add_file /etc/ssh/sshd_config
	add_dir /usr/
	add_dir /usr/bin/
	add_binary /usr/bin/findssl.sh
	add_binary /usr/bin/scp
	add_binary /usr/bin/sftp
	add_binary /usr/bin/ssh
	add_binary /usr/bin/ssh-add
	add_binary /usr/bin/ssh-agent
	add_binary /usr/bin/ssh-copy-id
	add_binary /usr/bin/ssh-keygen
	add_binary /usr/bin/ssh-keyscan
	add_binary /usr/bin/sshd
	add_dir /usr/lib/
	add_dir /usr/lib/ssh/
	add_file /usr/lib/ssh/sftp-server
	add_file /usr/lib/ssh/ssh-keysign
	add_file /usr/lib/ssh/ssh-pkcs11-helper
	add_dir /usr/lib/systemd/
	add_dir /usr/lib/systemd/system/
	add_file /usr/lib/systemd/system/sshd.service
	add_file /usr/lib/systemd/system/sshd.socket
	add_file /usr/lib/systemd/system/sshd@.service
	add_file /usr/lib/systemd/system/sshdgenkeys.service
	add_dir /usr/lib/tmpfiles.d/
	add_file /usr/lib/tmpfiles.d/sshd.conf
	add_dir /var/
	add_dir /var/empty/
	
	add_runscript
}

function help ()
{
	cat <<HELPEOF
This hook mounts the root file system from miscellaneous sources
HELPEOF
}
